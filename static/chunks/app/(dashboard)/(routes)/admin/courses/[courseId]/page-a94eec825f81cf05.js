(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[967],{3653:function(e,t,s){Promise.resolve().then(s.bind(s,9835)),Promise.resolve().then(s.bind(s,8415)),Promise.resolve().then(s.bind(s,779)),Promise.resolve().then(s.bind(s,2882)),Promise.resolve().then(s.bind(s,1800)),Promise.resolve().then(s.bind(s,7695)),Promise.resolve().then(s.bind(s,6944)),Promise.resolve().then(s.bind(s,1258)),Promise.resolve().then(s.bind(s,7303)),Promise.resolve().then(s.bind(s,3530)),Promise.resolve().then(s.bind(s,1507)),Promise.resolve().then(s.bind(s,1726)),Promise.resolve().then(s.bind(s,9776)),Promise.resolve().then(s.bind(s,1142)),Promise.resolve().then(s.t.bind(s,3388,23))},9835:function(e,t,s){"use strict";s.r(t);var r=s(7437),a=s(8634),n=s(3023),i=s(9222),l=s(4737),d=s(4033),o=s(2265),c=s(5925);t.default=e=>{let{disabled:t,courseId:s,isPublished:m}=e,u=(0,d.useRouter)(),[f,x]=o.useState(!1),p=async()=>{try{x(!0),m?(await i.Z.patch("/api/courses/".concat(s,"/unpublish")),c.ZP.success("已取消發布此課程")):(await i.Z.patch("/api/courses/".concat(s,"/publish")),c.ZP.success("已發布此課程")),u.refresh()}catch(e){c.ZP.error("有東西出錯了")}finally{x(!1)}},h=async()=>{try{x(!0),await i.Z.delete("/api/courses/".concat(s)),c.ZP.success("課程刪除成功"),u.refresh(),u.push("/admin/courses/".concat(s))}catch(e){c.ZP.error("有東西出錯了")}finally{x(!1)}};return(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(n.z,{onClick:p,disabled:t||f,variant:"outline",size:"sm",children:m?"取消發布":"發布"}),(0,r.jsx)(a.w,{onConfirm:h,children:(0,r.jsx)(n.z,{size:"sm",disabled:f,children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})})]})}},8415:function(e,t,s){"use strict";s.r(t),s.d(t,{AttachmentForm:function(){return p}});var r=s(7437),a=s(4578),n=s(9222),i=s(4033),l=s(3023),d=s(1981),o=s(8734),c=s(6264),m=s(2549),u=s(2265),f=s(5925),x=s(617);a.Ry({url:a.Z_().min(1)});let p=e=>{let{initialData:t,courseId:s}=e,[a,p]=u.useState(!1),[h,j]=u.useState(null),g=(0,i.useRouter)(),b=()=>p(e=>!e),y=async e=>{try{await n.Z.post("/api/courses/".concat(s,"/attachments"),e),f.ZP.success("更新成功"),b(),g.refresh()}catch(e){f.ZP.error("有東西出錯了")}},v=async e=>{try{j(e),await n.Z.delete("/api/courses/".concat(s,"/attachments/").concat(e)),f.ZP.success("刪除附件成功"),g.refresh()}catch(e){f.ZP.error("有東西出錯了")}finally{j(null)}};return(0,r.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程附件",(0,r.jsxs)(l.z,{variant:"ghost",onClick:b,children:[a&&(0,r.jsx)(r.Fragment,{children:"取消"}),!a&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"上傳附件"]})]})]}),!a&&(0,r.jsxs)(r.Fragment,{children:[0===t.attachments.length&&(0,r.jsx)("p",{className:"text-sm italic text-slate-500",children:"尚未上傳附件"}),t.attachments.length>0&&(0,r.jsx)("div",{className:"space-y-2",children:t.attachments.map(e=>(0,r.jsxs)("div",{className:"flex w-full items-start rounded-md border border-sky-200 bg-sky-100 p-3 text-sky-700",children:[(0,r.jsx)(o.Z,{className:"mr-2 h-4 w-4 flex-shrink-0"}),(0,r.jsx)("p",{className:"line-clamp-1 text-xs",children:e.name}),h===e.id&&(0,r.jsx)("div",{className:"ml-auto",children:(0,r.jsx)(c.Z,{className:"h-4 w-4 animate-spin"})}),h!==e.id&&(0,r.jsx)("button",{className:"ml-auto transition hover:opacity-75",onClick:()=>v(e.id),children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})})]},e.id))})]}),a&&(0,r.jsxs)("div",{children:[(0,r.jsx)(x.p,{endpoint:"courseAttachment",onChange:e=>{e&&y({url:e})}}),(0,r.jsx)("div",{className:"mt-4 text-xs text-muted-foreground",children:"上傳學生在課程中會用到的資料"})]})]})}},779:function(e,t,s){"use strict";s.r(t),s.d(t,{CategoryForm:function(){return G}});var r=s(7437),a=s(4578),n=s(9222),i=s(8110),l=s(1865),d=s(4033),o=s(459),c=s(3023),m=s(3905),u=s(2265),f=s(5925),x=s(9311),p=s(9957),h=s(2442),j=s(6478),g=s(1827),b=s(3452),y=s(2549);b.fC,b.xz;let v=b.h_,N=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(b.aV,{ref:t,className:(0,x.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a})});N.displayName=b.aV.displayName;let w=u.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(v,{children:[(0,r.jsx)(N,{}),(0,r.jsxs)(b.VY,{ref:t,className:(0,x.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",s),...n,children:[a,(0,r.jsxs)(b.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(y.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});w.displayName=b.VY.displayName;let Z=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(b.Dx,{ref:t,className:(0,x.cn)("text-lg font-semibold leading-none tracking-tight",s),...a})});Z.displayName=b.Dx.displayName;let k=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(b.dk,{ref:t,className:(0,x.cn)("text-sm text-muted-foreground",s),...a})});k.displayName=b.dk.displayName;let P=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(j.mY,{ref:t,className:(0,x.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...a})});P.displayName=j.mY.displayName;let R=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,r.jsx)(g.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,r.jsx)(j.mY.Input,{ref:t,className:(0,x.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...a})]})});R.displayName=j.mY.Input.displayName;let F=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(j.mY.List,{ref:t,className:(0,x.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...a})});F.displayName=j.mY.List.displayName;let z=u.forwardRef((e,t)=>(0,r.jsx)(j.mY.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));z.displayName=j.mY.Empty.displayName;let I=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(j.mY.Group,{ref:t,className:(0,x.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...a})});I.displayName=j.mY.Group.displayName;let C=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(j.mY.Separator,{ref:t,className:(0,x.cn)("-mx-1 h-px bg-border",s),...a})});C.displayName=j.mY.Separator.displayName;let S=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(j.mY.Item,{ref:t,className:(0,x.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a})});S.displayName=j.mY.Item.displayName;var _=s(3733);let Y=_.fC,V=_.xz,D=u.forwardRef((e,t)=>{let{className:s,align:a="center",sideOffset:n=4,...i}=e;return(0,r.jsx)(_.h_,{children:(0,r.jsx)(_.VY,{ref:t,align:a,sideOffset:n,className:(0,x.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})});D.displayName=_.VY.displayName;let E=e=>{var t;let{options:s,value:a,onChange:n}=e,[i,l]=u.useState(!1);return(0,r.jsxs)(Y,{open:i,onOpenChange:l,children:[(0,r.jsx)(V,{asChild:!0,children:(0,r.jsxs)(c.z,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between",children:[a?null===(t=s.find(e=>e.value===a))||void 0===t?void 0:t.label:"請選擇類別",(0,r.jsx)(p.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,r.jsx)(D,{className:"w-full p-0",children:(0,r.jsxs)(P,{children:[(0,r.jsx)(R,{placeholder:"搜尋..."}),(0,r.jsx)(z,{children:"查無類別資料"}),(0,r.jsx)(I,{children:s.map(e=>(0,r.jsxs)(S,{onSelect:()=>{n(e.value===a?"":e.value),l(!1)},children:[(0,r.jsx)(h.Z,{className:(0,x.cn)("mr-2 h-4 w-4",a===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})})]})},U=a.Ry({categoryId:a.Z_().min(1)}),G=e=>{let{initialData:t,courseId:s,options:a}=e,[p,h]=u.useState(!1),j=(0,d.useRouter)(),g=()=>h(e=>!e),b=(0,l.cI)({resolver:(0,i.F)(U),defaultValues:{categoryId:(null==t?void 0:t.categoryId)||""}}),{isSubmitting:y,isValid:v}=b.formState,N=async e=>{try{await n.Z.patch("/api/courses/".concat(s),e),f.ZP.success("更新成功"),g(),j.refresh()}catch(e){f.ZP.error("有東西出錯了")}},w=a.find(e=>e.value===t.categoryId);return(0,r.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程類別",(0,r.jsx)(c.z,{variant:"ghost",onClick:g,children:p?(0,r.jsx)(r.Fragment,{children:"取消"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"編輯類別"]})})]}),!p&&(0,r.jsx)("p",{className:(0,x.cn)("mt-2 text-sm",!t.categoryId&&"italic text-slate-500"),children:(null==w?void 0:w.label)||"尚未選擇類別"}),p&&(0,r.jsx)(o.l0,{...b,children:(0,r.jsxs)("form",{onSubmit:b.handleSubmit(N),className:"mt-4 space-y-4",children:[(0,r.jsx)(o.Wi,{control:b.control,name:"categoryId",render:e=>{let{field:t}=e,{value:s,onChange:n}=t;return(0,r.jsxs)(o.xJ,{children:[(0,r.jsx)(o.NI,{children:(0,r.jsx)(E,{options:a,onChange:n,value:s})}),(0,r.jsx)(o.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)(c.z,{disabled:!v||y,type:"submit",children:"儲存"})})]})})]})}},2882:function(e,t,s){"use strict";s.r(t),s.d(t,{ChapterForm:function(){return k}});var r=s(7437),a=s(4578),n=s(9222),i=s(8110),l=s(1865),d=s(4033),o=s(459),c=s(3023),m=s(6264),u=s(1981),f=s(2265),x=s(5925),p=s(9311),h=s(1908),j=s(8122),g=s(4664),b=s(3905),y=s(6061);let v=(0,y.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),N=e=>{let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,p.cn)(v({variant:s}),t),...a})};var w=e=>{let{items:t,onReorder:s,onEdit:a}=e,[n,i]=f.useState(!1),[l,d]=f.useState(t);return(f.useEffect(()=>{i(!0)},[]),f.useEffect(()=>{d(t)},[t]),n)?(0,r.jsx)(j.Z5,{onDragEnd:e=>{if(!e.destination)return;let t=Array.from(l),[r]=t.splice(e.source.index,1);t.splice(e.destination.index,0,r);let a=Math.min(e.source.index,e.destination.index),n=Math.max(e.source.index,e.destination.index),i=t.slice(a,n+1);d(t);let o=i.map(e=>({id:e.id,position:t.findIndex(t=>t.id===e.id)}));s(o)},children:(0,r.jsx)(j.bK,{droppableId:"chapters",children:e=>(0,r.jsxs)("div",{...e.droppableProps,ref:e.innerRef,children:[l.map((e,t)=>(0,r.jsx)(j._l,{draggableId:e.id,index:t,children:t=>(0,r.jsxs)("div",{className:(0,p.cn)("mb-4 flex items-center gap-x-2 rounded-md border border-slate-200 bg-slate-200 text-sm text-slate-700",e.isPublished&&"border-sky-200 bg-sky-100 text-sky-700"),ref:t.innerRef,...t.draggableProps,children:[(0,r.jsx)("div",{className:(0,p.cn)("rounded-l-md border-r border-r-slate-200 px-2 py-3 transition hover:bg-slate-300",e.isPublished&&"border-r-sky-200 hover:bg-sky-200"),...t.dragHandleProps,children:(0,r.jsx)(g.Z,{className:"h-5 w-5"})}),e.title,(0,r.jsxs)("div",{className:"ml-auto flex items-center gap-x-2 pr-2",children:[e.isFree&&(0,r.jsx)(N,{children:"免費"}),(0,r.jsx)(N,{className:(0,p.cn)("bg-slate-500",e.isPublished&&"bg-sky-700"),children:e.isPublished?"已發佈":"草稿"}),(0,r.jsx)(b.Z,{onClick:()=>a(e.id),className:"h-4 w-4 cursor-pointer transition hover:opacity-75"})]})]})},e.id)),e.placeholder]})})}):null};let Z=a.Ry({title:a.Z_().min(1)}),k=e=>{let{initialData:t,courseId:s}=e,[a,j]=f.useState(!1),[g,b]=f.useState(!1),y=(0,d.useRouter)(),v=()=>j(e=>!e),N=(0,l.cI)({resolver:(0,i.F)(Z),defaultValues:{title:""}}),{isSubmitting:k,isValid:P}=N.formState,R=async e=>{try{await n.Z.post("/api/courses/".concat(s,"/chapters"),e),x.ZP.success("課程章節建立完成"),v(),y.refresh()}catch(e){x.ZP.error("有東西出錯了")}},F=async e=>{try{b(!0),await n.Z.put("/api/courses/".concat(s,"/chapters/reorder"),{list:e}),x.ZP.success("課程章節順序更新完成"),y.refresh()}catch(e){x.ZP.error("有東西出錯了")}finally{b(!1)}};return(0,r.jsxs)("div",{className:"relative mt-6 rounded-md border bg-slate-100 p-4",children:[g&&(0,r.jsx)("div",{className:"absolute right-0 top-0 flex h-full w-full items-center justify-center rounded-md bg-slate-500/20",children:(0,r.jsx)(m.Z,{className:"h-6 w-6 animate-spin text-sky-700"})}),(0,r.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程章節",(0,r.jsx)(c.z,{variant:"ghost",onClick:v,children:a?(0,r.jsx)(r.Fragment,{children:"取消"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"建立章節"]})})]}),a&&(0,r.jsx)(o.l0,{...N,children:(0,r.jsxs)("form",{onSubmit:N.handleSubmit(R),className:"mt-4 space-y-4",children:[(0,r.jsx)(o.Wi,{control:N.control,name:"title",render:e=>{let{field:t}=e;return(0,r.jsxs)(o.xJ,{children:[(0,r.jsx)(o.NI,{children:(0,r.jsx)(h.I,{disabled:k,placeholder:"介紹課程...",...t})}),(0,r.jsx)(o.zG,{})]})}}),(0,r.jsx)(c.z,{disabled:!P||k,type:"submit",children:"建立"})]})}),!a&&(0,r.jsxs)("div",{className:(0,p.cn)("mt-2 text-sm",!t.chapters.length&&"italic text-slate-500"),children:[!t.chapters.length&&"尚未建立章節",(0,r.jsx)(w,{onEdit:e=>{y.push("/admin/courses/".concat(s,"/chapters/").concat(e))},onReorder:F,items:t.chapters||[]})]}),!a&&(0,r.jsx)("p",{className:"mt-4 text-xs text-muted-foreground",children:"拖拉前方圖示即可改變章節順序"})]})}},1800:function(e,t,s){"use strict";s.r(t),s.d(t,{DescriptionForm:function(){return j}});var r=s(7437),a=s(4578),n=s(9222),i=s(8110),l=s(1865),d=s(4033),o=s(459),c=s(3023),m=s(3905),u=s(2265),f=s(5925),x=s(9311);let p=u.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,x.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});p.displayName="Textarea";let h=a.Ry({description:a.Z_().min(1,{message:"描述是必填欄位"})}),j=e=>{let{initialData:t,courseId:s}=e,[a,j]=u.useState(!1),g=(0,d.useRouter)(),b=()=>j(e=>!e),y=(0,l.cI)({resolver:(0,i.F)(h),defaultValues:{description:t.description||""}}),{isSubmitting:v,isValid:N}=y.formState,w=async e=>{try{await n.Z.patch("/api/courses/".concat(s),e),f.ZP.success("更新成功"),b(),g.refresh()}catch(e){f.ZP.error("有東西出錯了")}};return(0,r.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程內容",(0,r.jsx)(c.z,{variant:"ghost",onClick:b,children:a?(0,r.jsx)(r.Fragment,{children:"取消"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"編輯內容"]})})]}),!a&&(0,r.jsx)("p",{className:(0,x.cn)("mt-2 text-sm",!t.description&&"italic text-slate-500"),children:t.description||"尚未添加內容"}),a&&(0,r.jsx)(o.l0,{...y,children:(0,r.jsxs)("form",{onSubmit:y.handleSubmit(w),className:"mt-4 space-y-4",children:[(0,r.jsx)(o.Wi,{control:y.control,name:"description",render:e=>{let{field:t}=e;return(0,r.jsxs)(o.xJ,{children:[(0,r.jsx)(o.NI,{children:(0,r.jsx)(p,{disabled:v,placeholder:'e.g. "網頁開發....."',...t})}),(0,r.jsx)(o.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)(c.z,{disabled:!N||v,type:"submit",children:"儲存"})})]})})]})}},7695:function(e,t,s){"use strict";s.r(t),s.d(t,{ImageForm:function(){return h}});var r=s(7437),a=s(4578),n=s(9222),i=s(4033),l=s(3023),d=s(1981),o=s(3905),c=s(8438),m=s(2265),u=s(5925),f=s(6691),x=s.n(f),p=s(617);a.Ry({imageUrl:a.Z_().min(1,{message:"圖片是必填欄位"})});let h=e=>{let{initialData:t,courseId:s}=e,[a,f]=m.useState(!1),h=(0,i.useRouter)(),j=()=>f(e=>!e),g=async e=>{try{await n.Z.patch("/api/courses/".concat(s),e),u.ZP.success("更新成功"),j(),h.refresh()}catch(e){u.ZP.error("有東西出錯了")}};return(0,r.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程圖片",(0,r.jsxs)(l.z,{variant:"ghost",onClick:j,children:[a&&(0,r.jsx)(r.Fragment,{children:"取消"}),!a&&!t.imageUrl&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"上傳圖片"]}),!a&&t.imageUrl&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),"編輯圖片"]})]})]}),!a&&(t.imageUrl?(0,r.jsx)("div",{className:"relative mt-2 aspect-square",children:(0,r.jsx)(x(),{alt:"Upload",fill:!0,className:"rounded-md object-cover",src:t.imageUrl})}):(0,r.jsx)("div",{className:"flex h-60 items-center justify-center rounded-md bg-slate-200",children:(0,r.jsx)(c.Z,{className:"h-10 w-10 text-slate-500"})})),a&&(0,r.jsxs)("div",{children:[(0,r.jsx)(p.p,{endpoint:"courseImage",onChange:e=>{e&&g({imageUrl:e})}}),(0,r.jsx)("div",{className:"mt-4 text-xs text-muted-foreground",children:"最佳圖片比例為1:1"})]})]})}},6944:function(e,t,s){"use strict";s.r(t),s.d(t,{PriceForm:function(){return g}});var r=s(7437),a=s(4578),n=s(9222),i=s(8110),l=s(1865),d=s(4033),o=s(459),c=s(3023),m=s(3905),u=s(2265),f=s(5925),x=s(9311),p=s(1908);let h=e=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"NTD",maximumFractionDigits:0}).format(e),j=a.Ry({price:a.oQ.number()}),g=e=>{let{initialData:t,courseId:s}=e,[a,g]=u.useState(!1),b=(0,d.useRouter)(),y=()=>g(e=>!e),v=(0,l.cI)({resolver:(0,i.F)(j),defaultValues:{price:t.price||void 0}}),{isSubmitting:N,isValid:w}=v.formState,Z=async e=>{try{await n.Z.patch("/api/courses/".concat(s),e),f.ZP.success("更新成功"),y(),b.refresh()}catch(e){f.ZP.error("有東西出錯了")}};return(0,r.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程價格",(0,r.jsx)(c.z,{variant:"ghost",onClick:y,children:a?(0,r.jsx)(r.Fragment,{children:"取消"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"編輯價格"]})})]}),!a&&(0,r.jsx)("p",{className:(0,x.cn)("mt-2 text-sm",!t.price&&"italic text-slate-500"),children:t.price?h(t.price):"尚未定價"}),a&&(0,r.jsx)(o.l0,{...v,children:(0,r.jsxs)("form",{onSubmit:v.handleSubmit(Z),className:"mt-4 space-y-4",children:[(0,r.jsx)(o.Wi,{control:v.control,name:"price",render:e=>{let{field:t}=e;return(0,r.jsxs)(o.xJ,{children:[(0,r.jsx)(o.NI,{children:(0,r.jsx)(p.I,{type:"number",step:"1",disabled:N,placeholder:"為您的課程定價",...t})}),(0,r.jsx)(o.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)(c.z,{disabled:!w||N,type:"submit",children:"儲存"})})]})})]})}},1258:function(e,t,s){"use strict";s.r(t),s.d(t,{TitleForm:function(){return h}});var r=s(7437),a=s(4578),n=s(9222),i=s(8110),l=s(1865),d=s(4033),o=s(459),c=s(3023),m=s(1908),u=s(3905),f=s(2265),x=s(5925);let p=a.Ry({title:a.Z_().min(1,{message:"名稱是必填欄位"})}),h=e=>{let{initialData:t,courseId:s}=e,[a,h]=f.useState(!1),j=(0,d.useRouter)(),g=()=>h(e=>!e),b=(0,l.cI)({resolver:(0,i.F)(p),defaultValues:t}),{isSubmitting:y,isValid:v}=b.formState,N=async e=>{try{await n.Z.patch("/api/courses/".concat(s),e),x.ZP.success("更新成功"),j.refresh(),g()}catch(e){x.ZP.error("有東西出錯了")}};return(0,r.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程標題",(0,r.jsx)(c.z,{variant:"ghost",onClick:g,children:a?(0,r.jsx)(r.Fragment,{children:"取消"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{className:"mr-2 h-4 w-4"}),"編輯標題"]})})]}),!a&&(0,r.jsx)("p",{className:"mt-2 text-sm",children:t.title}),a&&(0,r.jsx)(o.l0,{...b,children:(0,r.jsxs)("form",{onSubmit:b.handleSubmit(N),className:"mt-4 space-y-4",children:[(0,r.jsx)(o.Wi,{control:b.control,name:"title",render:e=>{let{field:t}=e;return(0,r.jsxs)(o.xJ,{children:[(0,r.jsx)(o.NI,{children:(0,r.jsx)(m.I,{disabled:y,placeholder:'e.g. "網頁開發指南"',...t})}),(0,r.jsx)(o.zG,{})]})}}),(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)(c.z,{disabled:!v||y,type:"submit",children:"儲存"})})]})})]})}},617:function(e,t,s){"use strict";s.d(t,{p:function(){return o}});var r=s(7437),a=s(5925),n=s(4854);let{UploadButton:i,UploadDropzone:l,Uploader:d}=(0,n.jp)(),o=e=>{let{onChange:t,endpoint:s}=e;return(0,r.jsx)(l,{endpoint:s,onClientUploadComplete:e=>{t(null==e?void 0:e[0].url)},onUploadError:e=>{a.ZP.error("".concat(null==e?void 0:e.message))}})}},8634:function(e,t,s){"use strict";s.d(t,{w:function(){return b}});var r=s(7437),a=s(2265),n=s(6645),i=s(9311),l=s(3023);let d=n.fC,o=n.xz,c=n.h_,m=a.forwardRef((e,t)=>{let{className:s,children:a,...l}=e;return(0,r.jsx)(n.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l,ref:t})});m.displayName=n.aV.displayName;let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(m,{}),(0,r.jsx)(n.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",s),...a})]})});u.displayName=n.VY.displayName;let f=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};f.displayName="AlertDialogHeader";let x=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};x.displayName="AlertDialogFooter";let p=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold",s),...a})});p.displayName=n.Dx.displayName;let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...a})});h.displayName=n.dk.displayName;let j=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.aU,{ref:t,className:(0,i.cn)((0,l.d)(),s),...a})});j.displayName=n.aU.displayName;let g=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(n.$j,{ref:t,className:(0,i.cn)((0,l.d)({variant:"outline"}),"mt-2 sm:mt-0",s),...a})});g.displayName=n.$j.displayName;let b=e=>{let{children:t,onConfirm:s}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(o,{asChild:!0,children:t}),(0,r.jsxs)(u,{children:[(0,r.jsxs)(f,{children:[(0,r.jsx)(p,{children:"確定執行此操作？"}),(0,r.jsx)(h,{children:"此操作執行後無法取消"})]}),(0,r.jsxs)(x,{children:[(0,r.jsx)(g,{children:"取消"}),(0,r.jsx)(j,{onClick:s,children:"繼續"})]})]})]})}},3023:function(e,t,s){"use strict";s.d(t,{d:function(){return d},z:function(){return o}});var r=s(7437),a=s(2265),n=s(7256),i=s(6061),l=s(9311);let d=(0,i.j)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:o=!1,...c}=e,m=o?n.g7:"button";return(0,r.jsx)(m,{className:(0,l.cn)(d({variant:a,size:i,className:s})),ref:t,...c})});o.displayName="Button"},459:function(e,t,s){"use strict";s.d(t,{l0:function(){return u},NI:function(){return b},pf:function(){return y},Wi:function(){return x},xJ:function(){return j},lX:function(){return g},zG:function(){return v}});var r=s(7437),a=s(2265),n=s(7256),i=s(1865),l=s(9311),d=s(6743),o=s(6061);let c=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),m=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(d.f,{ref:t,className:(0,l.cn)(c(),s),...a})});m.displayName=d.f.displayName;let u=i.RV,f=a.createContext({}),x=e=>{let{...t}=e;return(0,r.jsx)(f.Provider,{value:{name:t.name},children:(0,r.jsx)(i.Qr,{...t})})},p=()=>{let e=a.useContext(f),t=a.useContext(h),{getFieldState:s,formState:r}=(0,i.Gc)(),n=s(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...n}},h=a.createContext({}),j=a.forwardRef((e,t)=>{let{className:s,...n}=e,i=a.useId();return(0,r.jsx)(h.Provider,{value:{id:i},children:(0,r.jsx)("div",{ref:t,className:(0,l.cn)("space-y-2",s),...n})})});j.displayName="FormItem";let g=a.forwardRef((e,t)=>{let{className:s,...a}=e,{error:n,formItemId:i}=p();return(0,r.jsx)(m,{ref:t,className:(0,l.cn)(n&&"text-destructive",s),htmlFor:i,...a})});g.displayName="FormLabel";let b=a.forwardRef((e,t)=>{let{...s}=e,{error:a,formItemId:i,formDescriptionId:l,formMessageId:d}=p();return(0,r.jsx)(n.g7,{ref:t,id:i,"aria-describedby":a?"".concat(l," ").concat(d):"".concat(l),"aria-invalid":!!a,...s})});b.displayName="FormControl";let y=a.forwardRef((e,t)=>{let{className:s,...a}=e,{formDescriptionId:n}=p();return(0,r.jsx)("p",{ref:t,id:n,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});y.displayName="FormDescription";let v=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e,{error:i,formMessageId:d}=p(),o=i?String(null==i?void 0:i.message):a;return o?(0,r.jsx)("p",{ref:t,id:d,className:(0,l.cn)("text-sm font-medium text-destructive",s),...n,children:o}):null});v.displayName="FormMessage"},1908:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var r=s(7437),a=s(2265),n=s(9311);let i=a.forwardRef((e,t)=>{let{className:s,type:a,...i}=e;return(0,r.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},9311:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var r=s(7042),a=s(3986);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m)((0,r.W)(t))}}},function(e){e.O(0,[338,666,841,853,259,330,109,190,971,864,744],function(){return e(e.s=3653)}),_N_E=e.O()}]);