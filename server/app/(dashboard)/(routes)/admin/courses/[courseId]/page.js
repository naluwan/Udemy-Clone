(()=>{var e={};e.id=3967,e.ids=[3967],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},72477:e=>{"use strict";e.exports=require("node:stream/web")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},71267:e=>{"use strict";e.exports=require("worker_threads")},59796:e=>{"use strict";e.exports=require("zlib")},7870:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>m,routeModule:()=>p,tree:()=>c});var t=r(73137),a=r(54647),i=r(4183),n=r.n(i),o=r(71775),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);r.d(s,d);let l=t.AppPageRouteModule,c=["",{children:["(dashboard)",{children:["(routes)",{children:["admin",{children:["courses",{children:["[courseId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,61155)),"/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,22608)),"/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,51918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,55627)),"/home/runner/work/Udemy-Clone/Udemy-Clone/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,51918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],m=["/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/page.tsx"],u="/(dashboard)/(routes)/admin/courses/[courseId]/page",x={require:r,loadChunk:()=>Promise.resolve()},p=new l({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/(routes)/admin/courses/[courseId]/page",pathname:"/admin/courses/[courseId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},75683:(e,s,r)=>{Promise.resolve().then(r.bind(r,88077)),Promise.resolve().then(r.bind(r,86542)),Promise.resolve().then(r.bind(r,72243)),Promise.resolve().then(r.bind(r,54237)),Promise.resolve().then(r.bind(r,28903)),Promise.resolve().then(r.bind(r,4945)),Promise.resolve().then(r.bind(r,99539)),Promise.resolve().then(r.bind(r,59367)),Promise.resolve().then(r.bind(r,64092)),Promise.resolve().then(r.bind(r,52990)),Promise.resolve().then(r.bind(r,84102)),Promise.resolve().then(r.bind(r,54390)),Promise.resolve().then(r.bind(r,31704)),Promise.resolve().then(r.bind(r,90222)),Promise.resolve().then(r.t.bind(r,42796,23))},88077:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>u});var t=r(60080),a=r(68178),i=r(68384),n=r(93258),o=r(51734),d=r(57114),l=r(9885),c=r.n(l),m=r(10345);let u=({disabled:e,courseId:s,isPublished:r})=>{let l=(0,d.useRouter)(),[u,x]=c().useState(!1),p=async()=>{try{x(!0),r?(await n.Z.patch(`/api/courses/${s}/unpublish`),m.ZP.success("已取消發布此課程")):(await n.Z.patch(`/api/courses/${s}/publish`),m.ZP.success("已發布此課程")),l.refresh()}catch(e){m.ZP.error("有東西出錯了")}finally{x(!1)}},h=async()=>{try{x(!0),await n.Z.delete(`/api/courses/${s}`),m.ZP.success("課程刪除成功"),l.refresh(),l.push(`/admin/courses/${s}`)}catch(e){m.ZP.error("有東西出錯了")}finally{x(!1)}};return(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(i.z,{onClick:p,disabled:e||u,variant:"outline",size:"sm",children:r?"取消發布":"發布"}),t.jsx(a.w,{onConfirm:h,children:t.jsx(i.z,{size:"sm",disabled:u,children:t.jsx(o.Z,{className:"h-4 w-4"})})})]})}},86542:(e,s,r)=>{"use strict";r.r(s),r.d(s,{AttachmentForm:()=>f});var t=r(60080),a=r(19098),i=r(93258),n=r(57114),o=r(68384),d=r(82710),l=r(95595),c=r(80087),m=r(56206),u=r(9885),x=r.n(u),p=r(10345),h=r(21501);a.Ry({url:a.Z_().min(1)});let f=({initialData:e,courseId:s})=>{let[r,a]=x().useState(!1),[u,f]=x().useState(null),j=(0,n.useRouter)(),g=()=>a(e=>!e),y=async e=>{try{await i.Z.post(`/api/courses/${s}/attachments`,e),p.ZP.success("更新成功"),g(),j.refresh()}catch{p.ZP.error("有東西出錯了")}},b=async e=>{try{f(e),await i.Z.delete(`/api/courses/${s}/attachments/${e}`),p.ZP.success("刪除附件成功"),j.refresh()}catch{p.ZP.error("有東西出錯了")}finally{f(null)}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程附件",(0,t.jsxs)(o.z,{variant:"ghost",onClick:g,children:[r&&t.jsx(t.Fragment,{children:"取消"}),!r&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(d.Z,{className:"mr-2 h-4 w-4"}),"上傳附件"]})]})]}),!r&&(0,t.jsxs)(t.Fragment,{children:[0===e.attachments.length&&t.jsx("p",{className:"text-sm italic text-slate-500",children:"尚未上傳附件"}),e.attachments.length>0&&t.jsx("div",{className:"space-y-2",children:e.attachments.map(e=>(0,t.jsxs)("div",{className:"flex w-full items-start rounded-md border border-sky-200 bg-sky-100 p-3 text-sky-700",children:[t.jsx(l.Z,{className:"mr-2 h-4 w-4 flex-shrink-0"}),t.jsx("p",{className:"line-clamp-1 text-xs",children:e.name}),u===e.id&&t.jsx("div",{className:"ml-auto",children:t.jsx(c.Z,{className:"h-4 w-4 animate-spin"})}),u!==e.id&&t.jsx("button",{className:"ml-auto transition hover:opacity-75",onClick:()=>b(e.id),children:t.jsx(m.Z,{className:"h-4 w-4"})})]},e.id))})]}),r&&(0,t.jsxs)("div",{children:[t.jsx(h.p,{endpoint:"courseAttachment",onChange:e=>{e&&y({url:e})}}),t.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"上傳學生在課程中會用到的資料"})]})]})}},72243:(e,s,r)=>{"use strict";r.r(s),r.d(s,{CategoryForm:()=>V});var t=r(60080),a=r(19098),i=r(93258),n=r(83894),o=r(66558),d=r(57114),l=r(60806),c=r(68384),m=r(95196),u=r(9885),x=r.n(u),p=r(10345),h=r(23161),f=r(92974),j=r(1264),g=r(27754),y=r(69518),b=r(98885),v=r(56206);b.fC,b.xz;let N=b.h_,w=u.forwardRef(({className:e,...s},r)=>t.jsx(b.aV,{ref:r,className:(0,h.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));w.displayName=b.aV.displayName;let P=u.forwardRef(({className:e,children:s,...r},a)=>(0,t.jsxs)(N,{children:[t.jsx(w,{}),(0,t.jsxs)(b.VY,{ref:a,className:(0,h.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",e),...r,children:[s,(0,t.jsxs)(b.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(v.Z,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));P.displayName=b.VY.displayName;let Z=u.forwardRef(({className:e,...s},r)=>t.jsx(b.Dx,{ref:r,className:(0,h.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));Z.displayName=b.Dx.displayName;let C=u.forwardRef(({className:e,...s},r)=>t.jsx(b.dk,{ref:r,className:(0,h.cn)("text-sm text-muted-foreground",e),...s}));C.displayName=b.dk.displayName;let I=u.forwardRef(({className:e,...s},r)=>t.jsx(g.Command,{ref:r,className:(0,h.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...s}));I.displayName=g.Command.displayName;let k=u.forwardRef(({className:e,...s},r)=>(0,t.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[t.jsx(y.Z,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),t.jsx(g.Command.Input,{ref:r,className:(0,h.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...s})]}));k.displayName=g.Command.Input.displayName;let _=u.forwardRef(({className:e,...s},r)=>t.jsx(g.Command.List,{ref:r,className:(0,h.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...s}));_.displayName=g.Command.List.displayName;let q=u.forwardRef((e,s)=>t.jsx(g.Command.Empty,{ref:s,className:"py-6 text-center text-sm",...e}));q.displayName=g.Command.Empty.displayName;let F=u.forwardRef(({className:e,...s},r)=>t.jsx(g.Command.Group,{ref:r,className:(0,h.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...s}));F.displayName=g.Command.Group.displayName;let S=u.forwardRef(({className:e,...s},r)=>t.jsx(g.Command.Separator,{ref:r,className:(0,h.cn)("-mx-1 h-px bg-border",e),...s}));S.displayName=g.Command.Separator.displayName;let z=u.forwardRef(({className:e,...s},r)=>t.jsx(g.Command.Item,{ref:r,className:(0,h.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s}));z.displayName=g.Command.Item.displayName;var U=r(14704);let R=U.fC,$=U.xz,G=u.forwardRef(({className:e,align:s="center",sideOffset:r=4,...a},i)=>t.jsx(U.h_,{children:t.jsx(U.VY,{ref:i,align:s,sideOffset:r,className:(0,h.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...a})}));G.displayName=U.VY.displayName;let D=({options:e,value:s,onChange:r})=>{let[a,i]=u.useState(!1);return(0,t.jsxs)(R,{open:a,onOpenChange:i,children:[t.jsx($,{asChild:!0,children:(0,t.jsxs)(c.z,{variant:"outline",role:"combobox","aria-expanded":a,className:"w-full justify-between",children:[s?e.find(e=>e.value===s)?.label:"請選擇類別",t.jsx(f.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),t.jsx(G,{className:"w-full p-0",children:(0,t.jsxs)(I,{children:[t.jsx(k,{placeholder:"搜尋..."}),t.jsx(q,{children:"查無類別資料"}),t.jsx(F,{children:e.map(e=>(0,t.jsxs)(z,{onSelect:()=>{r(e.value===s?"":e.value),i(!1)},children:[t.jsx(j.Z,{className:(0,h.cn)("mr-2 h-4 w-4",s===e.value?"opacity-100":"opacity-0")}),e.label]},e.value))})]})})]})},M=a.Ry({categoryId:a.Z_().min(1)}),V=({initialData:e,courseId:s,options:r})=>{let[a,u]=x().useState(!1),f=(0,d.useRouter)(),j=()=>u(e=>!e),g=(0,o.cI)({resolver:(0,n.F)(M),defaultValues:{categoryId:e?.categoryId||""}}),{isSubmitting:y,isValid:b}=g.formState,v=async e=>{try{await i.Z.patch(`/api/courses/${s}`,e),p.ZP.success("更新成功"),j(),f.refresh()}catch{p.ZP.error("有東西出錯了")}},N=r.find(s=>s.value===e.categoryId);return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程類別",t.jsx(c.z,{variant:"ghost",onClick:j,children:a?t.jsx(t.Fragment,{children:"取消"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(m.Z,{className:"mr-2 h-4 w-4"}),"編輯類別"]})})]}),!a&&t.jsx("p",{className:(0,h.cn)("mt-2 text-sm",!e.categoryId&&"italic text-slate-500"),children:N?.label||"尚未選擇類別"}),a&&t.jsx(l.l0,{...g,children:(0,t.jsxs)("form",{onSubmit:g.handleSubmit(v),className:"mt-4 space-y-4",children:[t.jsx(l.Wi,{control:g.control,name:"categoryId",render:({field:e})=>{let{value:s,onChange:a}=e;return(0,t.jsxs)(l.xJ,{children:[t.jsx(l.NI,{children:t.jsx(D,{options:r,onChange:a,value:s})}),t.jsx(l.zG,{})]})}}),t.jsx("div",{className:"flex items-center gap-x-2",children:t.jsx(c.z,{disabled:!b||y,type:"submit",children:"儲存"})})]})})]})}},54237:(e,s,r)=>{"use strict";r.r(s),r.d(s,{ChapterForm:()=>C});var t=r(60080),a=r(19098),i=r(93258),n=r(83894),o=r(66558),d=r(57114),l=r(60806),c=r(68384),m=r(80087),u=r(82710),x=r(9885),p=r.n(x),h=r(10345),f=r(23161),j=r(49424),g=r(32470),y=r(7723),b=r(95196),v=r(91971);let N=(0,v.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}}),w=({className:e,variant:s,...r})=>t.jsx("div",{className:(0,f.cn)(N({variant:s}),e),...r}),P=({items:e,onReorder:s,onEdit:r})=>{let[a,i]=p().useState(!1),[n,o]=p().useState(e);return(p().useEffect(()=>{i(!0)},[]),p().useEffect(()=>{o(e)},[e]),a)?t.jsx(g.Z5,{onDragEnd:e=>{if(!e.destination)return;let r=Array.from(n),[t]=r.splice(e.source.index,1);r.splice(e.destination.index,0,t);let a=Math.min(e.source.index,e.destination.index),i=Math.max(e.source.index,e.destination.index),d=r.slice(a,i+1);o(r);let l=d.map(e=>({id:e.id,position:r.findIndex(s=>s.id===e.id)}));s(l)},children:t.jsx(g.bK,{droppableId:"chapters",children:e=>(0,t.jsxs)("div",{...e.droppableProps,ref:e.innerRef,children:[n.map((e,s)=>t.jsx(g._l,{draggableId:e.id,index:s,children:s=>(0,t.jsxs)("div",{className:(0,f.cn)("mb-4 flex items-center gap-x-2 rounded-md border border-slate-200 bg-slate-200 text-sm text-slate-700",e.isPublished&&"border-sky-200 bg-sky-100 text-sky-700"),ref:s.innerRef,...s.draggableProps,children:[t.jsx("div",{className:(0,f.cn)("rounded-l-md border-r border-r-slate-200 px-2 py-3 transition hover:bg-slate-300",e.isPublished&&"border-r-sky-200 hover:bg-sky-200"),...s.dragHandleProps,children:t.jsx(y.Z,{className:"h-5 w-5"})}),e.title,(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-x-2 pr-2",children:[e.isFree&&t.jsx(w,{children:"免費"}),t.jsx(w,{className:(0,f.cn)("bg-slate-500",e.isPublished&&"bg-sky-700"),children:e.isPublished?"已發佈":"草稿"}),t.jsx(b.Z,{onClick:()=>r(e.id),className:"h-4 w-4 cursor-pointer transition hover:opacity-75"})]})]})},e.id)),e.placeholder]})})}):null},Z=a.Ry({title:a.Z_().min(1)}),C=({initialData:e,courseId:s})=>{let[r,a]=p().useState(!1),[x,g]=p().useState(!1),y=(0,d.useRouter)(),b=()=>a(e=>!e),v=(0,o.cI)({resolver:(0,n.F)(Z),defaultValues:{title:""}}),{isSubmitting:N,isValid:w}=v.formState,C=async e=>{try{await i.Z.post(`/api/courses/${s}/chapters`,e),h.ZP.success("課程章節建立完成"),b(),y.refresh()}catch{h.ZP.error("有東西出錯了")}},I=async e=>{try{g(!0),await i.Z.put(`/api/courses/${s}/chapters/reorder`,{list:e}),h.ZP.success("課程章節順序更新完成"),y.refresh()}catch{h.ZP.error("有東西出錯了")}finally{g(!1)}};return(0,t.jsxs)("div",{className:"relative mt-6 rounded-md border bg-slate-100 p-4",children:[x&&t.jsx("div",{className:"absolute right-0 top-0 flex h-full w-full items-center justify-center rounded-md bg-slate-500/20",children:t.jsx(m.Z,{className:"h-6 w-6 animate-spin text-sky-700"})}),(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程章節",t.jsx(c.z,{variant:"ghost",onClick:b,children:r?t.jsx(t.Fragment,{children:"取消"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(u.Z,{className:"mr-2 h-4 w-4"}),"建立章節"]})})]}),r&&t.jsx(l.l0,{...v,children:(0,t.jsxs)("form",{onSubmit:v.handleSubmit(C),className:"mt-4 space-y-4",children:[t.jsx(l.Wi,{control:v.control,name:"title",render:({field:e})=>(0,t.jsxs)(l.xJ,{children:[t.jsx(l.NI,{children:t.jsx(j.I,{disabled:N,placeholder:"介紹課程...",...e})}),t.jsx(l.zG,{})]})}),t.jsx(c.z,{disabled:!w||N,type:"submit",children:"建立"})]})}),!r&&(0,t.jsxs)("div",{className:(0,f.cn)("mt-2 text-sm",!e.chapters.length&&"italic text-slate-500"),children:[!e.chapters.length&&"尚未建立章節",t.jsx(P,{onEdit:e=>{y.push(`/admin/courses/${s}/chapters/${e}`)},onReorder:I,items:e.chapters||[]})]}),!r&&t.jsx("p",{className:"mt-4 text-xs text-muted-foreground",children:"拖拉前方圖示即可改變章節順序"})]})}},28903:(e,s,r)=>{"use strict";r.r(s),r.d(s,{DescriptionForm:()=>g});var t=r(60080),a=r(19098),i=r(93258),n=r(83894),o=r(66558),d=r(57114),l=r(60806),c=r(68384),m=r(95196),u=r(9885),x=r.n(u),p=r(10345),h=r(23161);let f=u.forwardRef(({className:e,...s},r)=>t.jsx("textarea",{className:(0,h.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...s}));f.displayName="Textarea";let j=a.Ry({description:a.Z_().min(1,{message:"描述是必填欄位"})}),g=({initialData:e,courseId:s})=>{let[r,a]=x().useState(!1),u=(0,d.useRouter)(),g=()=>a(e=>!e),y=(0,o.cI)({resolver:(0,n.F)(j),defaultValues:{description:e.description||""}}),{isSubmitting:b,isValid:v}=y.formState,N=async e=>{try{await i.Z.patch(`/api/courses/${s}`,e),p.ZP.success("更新成功"),g(),u.refresh()}catch{p.ZP.error("有東西出錯了")}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程內容",t.jsx(c.z,{variant:"ghost",onClick:g,children:r?t.jsx(t.Fragment,{children:"取消"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(m.Z,{className:"mr-2 h-4 w-4"}),"編輯內容"]})})]}),!r&&t.jsx("p",{className:(0,h.cn)("mt-2 text-sm",!e.description&&"italic text-slate-500"),children:e.description||"尚未添加內容"}),r&&t.jsx(l.l0,{...y,children:(0,t.jsxs)("form",{onSubmit:y.handleSubmit(N),className:"mt-4 space-y-4",children:[t.jsx(l.Wi,{control:y.control,name:"description",render:({field:e})=>(0,t.jsxs)(l.xJ,{children:[t.jsx(l.NI,{children:t.jsx(f,{disabled:b,placeholder:'e.g. "網頁開發....."',...e})}),t.jsx(l.zG,{})]})}),t.jsx("div",{className:"flex items-center gap-x-2",children:t.jsx(c.z,{disabled:!v||b,type:"submit",children:"儲存"})})]})})]})}},4945:(e,s,r)=>{"use strict";r.r(s),r.d(s,{ImageForm:()=>j});var t=r(60080),a=r(19098),i=r(93258),n=r(57114),o=r(68384),d=r(82710),l=r(95196),c=r(80443),m=r(9885),u=r.n(m),x=r(10345),p=r(52451),h=r.n(p),f=r(21501);a.Ry({imageUrl:a.Z_().min(1,{message:"圖片是必填欄位"})});let j=({initialData:e,courseId:s})=>{let[r,a]=u().useState(!1),m=(0,n.useRouter)(),p=()=>a(e=>!e),j=async e=>{try{await i.Z.patch(`/api/courses/${s}`,e),x.ZP.success("更新成功"),p(),m.refresh()}catch{x.ZP.error("有東西出錯了")}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程圖片",(0,t.jsxs)(o.z,{variant:"ghost",onClick:p,children:[r&&t.jsx(t.Fragment,{children:"取消"}),!r&&!e.imageUrl&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(d.Z,{className:"mr-2 h-4 w-4"}),"上傳圖片"]}),!r&&e.imageUrl&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(l.Z,{className:"mr-2 h-4 w-4"}),"編輯圖片"]})]})]}),!r&&(e.imageUrl?t.jsx("div",{className:"relative mt-2 aspect-square",children:t.jsx(h(),{alt:"Upload",fill:!0,className:"rounded-md object-cover",src:e.imageUrl})}):t.jsx("div",{className:"flex h-60 items-center justify-center rounded-md bg-slate-200",children:t.jsx(c.Z,{className:"h-10 w-10 text-slate-500"})})),r&&(0,t.jsxs)("div",{children:[t.jsx(f.p,{endpoint:"courseImage",onChange:e=>{e&&j({imageUrl:e})}}),t.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"最佳圖片比例為1:1"})]})]})}},99539:(e,s,r)=>{"use strict";r.r(s),r.d(s,{PriceForm:()=>y});var t=r(60080),a=r(19098),i=r(93258),n=r(83894),o=r(66558),d=r(57114),l=r(60806),c=r(68384),m=r(95196),u=r(9885),x=r.n(u),p=r(10345),h=r(23161),f=r(49424);let j=e=>new Intl.NumberFormat("zh-TW",{style:"currency",currency:"NTD",maximumFractionDigits:0}).format(e),g=a.Ry({price:a.oQ.number()}),y=({initialData:e,courseId:s})=>{let[r,a]=x().useState(!1),u=(0,d.useRouter)(),y=()=>a(e=>!e),b=(0,o.cI)({resolver:(0,n.F)(g),defaultValues:{price:e.price||void 0}}),{isSubmitting:v,isValid:N}=b.formState,w=async e=>{try{await i.Z.patch(`/api/courses/${s}`,e),p.ZP.success("更新成功"),y(),u.refresh()}catch{p.ZP.error("有東西出錯了")}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程價格",t.jsx(c.z,{variant:"ghost",onClick:y,children:r?t.jsx(t.Fragment,{children:"取消"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(m.Z,{className:"mr-2 h-4 w-4"}),"編輯價格"]})})]}),!r&&t.jsx("p",{className:(0,h.cn)("mt-2 text-sm",!e.price&&"italic text-slate-500"),children:e.price?j(e.price):"尚未定價"}),r&&t.jsx(l.l0,{...b,children:(0,t.jsxs)("form",{onSubmit:b.handleSubmit(w),className:"mt-4 space-y-4",children:[t.jsx(l.Wi,{control:b.control,name:"price",render:({field:e})=>(0,t.jsxs)(l.xJ,{children:[t.jsx(l.NI,{children:t.jsx(f.I,{type:"number",step:"1",disabled:v,placeholder:"為您的課程定價",...e})}),t.jsx(l.zG,{})]})}),t.jsx("div",{className:"flex items-center gap-x-2",children:t.jsx(c.z,{disabled:!N||v,type:"submit",children:"儲存"})})]})})]})}},59367:(e,s,r)=>{"use strict";r.r(s),r.d(s,{TitleForm:()=>j});var t=r(60080),a=r(19098),i=r(93258),n=r(83894),o=r(66558),d=r(57114),l=r(60806),c=r(68384),m=r(49424),u=r(95196),x=r(9885),p=r.n(x),h=r(10345);let f=a.Ry({title:a.Z_().min(1,{message:"名稱是必填欄位"})}),j=({initialData:e,courseId:s})=>{let[r,a]=p().useState(!1),x=(0,d.useRouter)(),j=()=>a(e=>!e),g=(0,o.cI)({resolver:(0,n.F)(f),defaultValues:e}),{isSubmitting:y,isValid:b}=g.formState,v=async e=>{try{await i.Z.patch(`/api/courses/${s}`,e),h.ZP.success("更新成功"),x.refresh(),j()}catch{h.ZP.error("有東西出錯了")}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["課程標題",t.jsx(c.z,{variant:"ghost",onClick:j,children:r?t.jsx(t.Fragment,{children:"取消"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(u.Z,{className:"mr-2 h-4 w-4"}),"編輯標題"]})})]}),!r&&t.jsx("p",{className:"mt-2 text-sm",children:e.title}),r&&t.jsx(l.l0,{...g,children:(0,t.jsxs)("form",{onSubmit:g.handleSubmit(v),className:"mt-4 space-y-4",children:[t.jsx(l.Wi,{control:g.control,name:"title",render:({field:e})=>(0,t.jsxs)(l.xJ,{children:[t.jsx(l.NI,{children:t.jsx(m.I,{disabled:y,placeholder:'e.g. "網頁開發指南"',...e})}),t.jsx(l.zG,{})]})}),t.jsx("div",{className:"flex items-center gap-x-2",children:t.jsx(c.z,{disabled:!b||y,type:"submit",children:"儲存"})})]})})]})}},61155:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>Y});var t=r(48144),a=r(2654),i=r(30953),n=r(38798),o=r(15055),d=r(60861),l=r(59623),c=r(41448),m=r(6465),u=r(17536);let x=(0,u.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/_components/title-form.tsx`),{__esModule:p,$$typeof:h}=x;x.default;let f=x.TitleForm,j=(0,u.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/_components/description-form.tsx`),{__esModule:g,$$typeof:y}=j;j.default;let b=j.DescriptionForm,v=(0,u.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/_components/image-form.tsx`),{__esModule:N,$$typeof:w}=v;v.default;let P=v.ImageForm,Z=(0,u.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/_components/category-form.tsx`),{__esModule:C,$$typeof:I}=Z;Z.default;let k=Z.CategoryForm,_=(0,u.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/_components/price-form.tsx`),{__esModule:q,$$typeof:F}=_;_.default;let S=_.PriceForm,z=(0,u.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/_components/attachments-form.tsx`),{__esModule:U,$$typeof:R}=z;z.default;let $=z.AttachmentForm,G=(0,u.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/_components/chapter-form.tsx`),{__esModule:D,$$typeof:M}=G;G.default;let V=G.ChapterForm;var E=r(76563);let A=(0,u.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/_components/actions.tsx`),{__esModule:T,$$typeof:W}=A,B=A.default,J=async({params:e})=>{let{userId:s}=(0,n.I8)();if(!s)return(0,m.redirect)("/");let r=await i.db.course.findUnique({where:{id:e.courseId,userId:s},include:{chapters:{orderBy:{position:"asc"}},attachments:{orderBy:{createdAt:"desc"}}}}),u=await i.db.category.findMany({orderBy:{name:"asc"}});if(!r)return(0,m.redirect)("/");let x=[r.title,r.description,r.imageUrl,r.price,r.categoryId,r.chapters.some(e=>e.isPublished)],p=x.length,h=x.filter(Boolean).length,j=`(${h}/${p})`,g=x.every(Boolean);return(0,t.jsxs)(t.Fragment,{children:[!r.isPublished&&t.jsx(E.j,{label:"此課程尚未發布，將不會顯示在學生課程頁面中"}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-y-2",children:[t.jsx("h1",{className:"text-2xl font-medium",children:"課程設定"}),(0,t.jsxs)("span",{className:"text-sm text-slate-700",children:["完成課程設定步驟 ",j]})]}),t.jsx(B,{disabled:!g,courseId:e.courseId,isPublished:r.isPublished})]}),(0,t.jsxs)("div",{className:"mt-16 grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(a.G,{icon:o.Z}),t.jsx("h2",{className:"text-xl",children:"完成您的課程設定"})]}),t.jsx(f,{initialData:r,courseId:r.id}),t.jsx(b,{initialData:r,courseId:r.id}),t.jsx(P,{initialData:r,courseId:r.id}),t.jsx(k,{initialData:r,courseId:r.id,options:u.map(e=>({label:e.name,value:e.id}))})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(a.G,{icon:d.Z}),t.jsx("h2",{className:"text-xl",children:"課程章節"})]}),t.jsx("div",{children:t.jsx(V,{initialData:r,courseId:r.id})})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(a.G,{icon:l.Z}),t.jsx("h2",{className:"text-xl",children:"價格設定"})]}),t.jsx(S,{initialData:r,courseId:r.id})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(a.G,{icon:c.Z}),t.jsx("h2",{className:"text-xl",children:"課程資源 & 附件"})]}),t.jsx($,{initialData:r,courseId:r.id})]})]})]})]})]})},Y=J}};var s=require("../../../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[5893,3159,6885,2703,7112,2002,1477,9161,953,4650,7120,5062,3644],()=>r(7870));module.exports=t})();