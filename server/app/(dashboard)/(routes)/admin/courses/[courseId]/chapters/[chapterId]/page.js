(()=>{var e={};e.id=480,e.ids=[480],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},72254:e=>{"use strict";e.exports=require("node:buffer")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},88849:e=>{"use strict";e.exports=require("node:http")},22286:e=>{"use strict";e.exports=require("node:https")},87503:e=>{"use strict";e.exports=require("node:net")},49411:e=>{"use strict";e.exports=require("node:path")},97742:e=>{"use strict";e.exports=require("node:process")},84492:e=>{"use strict";e.exports=require("node:stream")},72477:e=>{"use strict";e.exports=require("node:stream/web")},41041:e=>{"use strict";e.exports=require("node:url")},47261:e=>{"use strict";e.exports=require("node:util")},65628:e=>{"use strict";e.exports=require("node:zlib")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},12781:e=>{"use strict";e.exports=require("stream")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},71267:e=>{"use strict";e.exports=require("worker_threads")},59796:e=>{"use strict";e.exports=require("zlib")},77869:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>u,routeModule:()=>p,tree:()=>l});var t=r(73137),i=r(54647),a=r(4183),n=r.n(a),c=r(71775),o={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>c[e]);r.d(s,o);let d=t.AppPageRouteModule,l=["",{children:["(dashboard)",{children:["(routes)",{children:["admin",{children:["courses",{children:["[courseId]",{children:["chapters",{children:["[chapterId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,12300)),"/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/page.tsx"]}]},{}]},{}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,22608)),"/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,51918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,55627)),"/home/runner/work/Udemy-Clone/Udemy-Clone/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,51918,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/page.tsx"],m="/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/page",h={require:r,loadChunk:()=>Promise.resolve()},p=new d({definition:{kind:i.x.APP_PAGE,page:"/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/page",pathname:"/admin/courses/[courseId]/chapters/[chapterId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},2170:(e,s,r)=>{Promise.resolve().then(r.bind(r,98287)),Promise.resolve().then(r.bind(r,73098)),Promise.resolve().then(r.bind(r,81)),Promise.resolve().then(r.bind(r,68401)),Promise.resolve().then(r.bind(r,45728)),Promise.resolve().then(r.bind(r,64092)),Promise.resolve().then(r.bind(r,52990)),Promise.resolve().then(r.bind(r,84102)),Promise.resolve().then(r.bind(r,54390)),Promise.resolve().then(r.bind(r,31704)),Promise.resolve().then(r.bind(r,90222)),Promise.resolve().then(r.t.bind(r,41297,23)),Promise.resolve().then(r.t.bind(r,42796,23))},98287:(e,s,r)=>{"use strict";r.r(s),r.d(s,{ChapterAccessForm:()=>y});var t=r(60080),i=r(19098),a=r(93258),n=r(83894),c=r(66558),o=r(57114),d=r(60806),l=r(68384),u=r(95196),m=r(9885),h=r.n(m),p=r(10345),x=r(23161),j=r(97312),f=r(1264);let b=m.forwardRef(({className:e,...s},r)=>t.jsx(j.fC,{ref:r,className:(0,x.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:t.jsx(j.z$,{className:(0,x.cn)("flex items-center justify-center text-current"),children:t.jsx(f.Z,{className:"h-4 w-4"})})}));b.displayName=j.fC.displayName;let v=i.Ry({isFree:i.O7().default(!1)}),y=({initialData:e,courseId:s,chapterId:r})=>{let[i,m]=h().useState(!1),j=(0,o.useRouter)(),f=()=>m(e=>!e),y=(0,c.cI)({resolver:(0,n.F)(v),defaultValues:{isFree:!!e.isFree}}),{isSubmitting:g,isValid:w}=y.formState,N=async e=>{try{await a.Z.patch(`/api/courses/${s}/chapters/${r}`,e),p.ZP.success("更新成功"),f(),j.refresh()}catch{p.ZP.error("有東西出錯了")}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["章節權限",t.jsx(l.z,{variant:"ghost",onClick:f,children:i?t.jsx(t.Fragment,{children:"取消"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(u.Z,{className:"mr-2 h-4 w-4"}),"編輯權限"]})})]}),!i&&t.jsx("p",{className:(0,x.cn)("mt-2 text-sm",!e.isFree&&"italic text-slate-500"),children:e.isFree?t.jsx(t.Fragment,{children:"本章節可免費觀看"}):t.jsx(t.Fragment,{children:"本章節無法免費觀看"})}),i&&t.jsx(d.l0,{...y,children:(0,t.jsxs)("form",{onSubmit:y.handleSubmit(N),className:"mt-4 space-y-4",children:[t.jsx(d.Wi,{control:y.control,name:"isFree",render:({field:e})=>(0,t.jsxs)(d.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[t.jsx(d.NI,{children:t.jsx(b,{checked:e.value,onCheckedChange:e.onChange})}),t.jsx("div",{className:"space-y-1 leading-none",children:t.jsx(d.pf,{children:"勾選即可設定成免費觀看"})})]})}),t.jsx("div",{className:"flex items-center gap-x-2",children:t.jsx(l.z,{disabled:!w||g,type:"submit",children:"儲存"})})]})})]})}},73098:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>m});var t=r(60080),i=r(68178),a=r(68384),n=r(93258),c=r(51734),o=r(57114),d=r(9885),l=r.n(d),u=r(10345);let m=({disabled:e,courseId:s,chapterId:r,isPublished:d})=>{let m=(0,o.useRouter)(),[h,p]=l().useState(!1),x=async()=>{try{p(!0),d?(await n.Z.patch(`/api/courses/${s}/chapters/${r}/unpublish`),u.ZP.success("已取消發布此章節")):(await n.Z.patch(`/api/courses/${s}/chapters/${r}/publish`),u.ZP.success("已發布此章節")),m.refresh()}catch(e){u.ZP.error("有東西出錯了")}finally{p(!1)}},j=async()=>{try{p(!0),await n.Z.delete(`/api/courses/${s}/chapters/${r}`),u.ZP.success("章節刪除成功"),m.refresh(),m.push(`/admin/courses/${s}`)}catch(e){u.ZP.error("有東西出錯了")}finally{p(!1)}};return(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(a.z,{onClick:x,disabled:e||h,variant:"outline",size:"sm",children:d?"取消發布":"發布"}),t.jsx(i.w,{onConfirm:j,children:t.jsx(a.z,{size:"sm",disabled:h,children:t.jsx(c.Z,{className:"h-4 w-4"})})})]})}},81:(e,s,r)=>{"use strict";r.r(s),r.d(s,{ChapterDescriptionForm:()=>g});var t=r(60080),i=r(19098),a=r(93258),n=r(83894),c=r(66558),o=r(57114),d=r(60806),l=r(68384),u=r(95196),m=r(9885),h=r.n(m),p=r(10345),x=r(23161),j=r(69275),f=r.n(j);r(24221);let b=({onChange:e,value:s})=>{let i=h().useMemo(()=>f()(()=>r.e(2182).then(r.t.bind(r,12182,23)),{loadableGenerated:{modules:["/home/runner/work/Udemy-Clone/Udemy-Clone/components/editor.tsx -> react-quill"]},ssr:!1}),[]);return t.jsx("div",{className:"bg-white",children:t.jsx(i,{theme:"snow",value:s,onChange:e})})};r(15168);let v=({value:e})=>{let s=h().useMemo(()=>f()(()=>r.e(2182).then(r.t.bind(r,12182,23)),{loadableGenerated:{modules:["/home/runner/work/Udemy-Clone/Udemy-Clone/components/preview.tsx -> react-quill"]},ssr:!1}),[]);return t.jsx(s,{theme:"bubble",value:e,readOnly:!0})},y=i.Ry({description:i.Z_().min(1)}),g=({initialData:e,courseId:s,chapterId:r})=>{let[i,m]=h().useState(!1),j=(0,o.useRouter)(),f=()=>m(e=>!e),g=(0,c.cI)({resolver:(0,n.F)(y),defaultValues:{description:e.description||""}}),{isSubmitting:w,isValid:N}=g.formState,I=async e=>{try{await a.Z.patch(`/api/courses/${s}/chapters/${r}`,e),p.ZP.success("更新成功"),f(),j.refresh()}catch{p.ZP.error("有東西出錯了")}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["章節內容",t.jsx(l.z,{variant:"ghost",onClick:f,children:i?t.jsx(t.Fragment,{children:"取消"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(u.Z,{className:"mr-2 h-4 w-4"}),"編輯內容"]})})]}),!i&&(0,t.jsxs)("div",{className:(0,x.cn)("mt-2 text-sm",!e.description&&"italic text-slate-500"),children:[!e.description&&"尚未添加內容",e.description&&t.jsx(v,{value:e.description})]}),i&&t.jsx(d.l0,{...g,children:(0,t.jsxs)("form",{onSubmit:g.handleSubmit(I),className:"mt-4 space-y-4",children:[t.jsx(d.Wi,{control:g.control,name:"description",render:({field:e})=>(0,t.jsxs)(d.xJ,{children:[t.jsx(d.NI,{children:t.jsx(b,{...e})}),t.jsx(d.zG,{})]})}),t.jsx("div",{className:"flex items-center gap-x-2",children:t.jsx(l.z,{disabled:!N||w,type:"submit",children:"儲存"})})]})})]})}},68401:(e,s,r)=>{"use strict";r.r(s),r.d(s,{ChapterTitleForm:()=>f});var t=r(60080),i=r(19098),a=r(93258),n=r(83894),c=r(66558),o=r(57114),d=r(60806),l=r(68384),u=r(49424),m=r(95196),h=r(9885),p=r.n(h),x=r(10345);let j=i.Ry({title:i.Z_().min(1)}),f=({initialData:e,courseId:s,chapterId:r})=>{let[i,h]=p().useState(!1),f=(0,o.useRouter)(),b=()=>h(e=>!e),v=(0,c.cI)({resolver:(0,n.F)(j),defaultValues:e}),{isSubmitting:y,isValid:g}=v.formState,w=async e=>{try{await a.Z.patch(`/api/courses/${s}/chapters/${r}`,e),x.ZP.success("更新成功"),f.refresh(),b()}catch{x.ZP.error("有東西出錯了")}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["章節標題",t.jsx(l.z,{variant:"ghost",onClick:b,children:i?t.jsx(t.Fragment,{children:"取消"}):(0,t.jsxs)(t.Fragment,{children:[t.jsx(m.Z,{className:"mr-2 h-4 w-4"}),"編輯標題"]})})]}),!i&&t.jsx("p",{className:"mt-2 text-sm",children:e.title}),i&&t.jsx(d.l0,{...v,children:(0,t.jsxs)("form",{onSubmit:v.handleSubmit(w),className:"mt-4 space-y-4",children:[t.jsx(d.Wi,{control:v.control,name:"title",render:({field:e})=>(0,t.jsxs)(d.xJ,{children:[t.jsx(d.NI,{children:t.jsx(u.I,{disabled:y,placeholder:'e.g. "章節介紹..."',...e})}),t.jsx(d.zG,{})]})}),t.jsx("div",{className:"flex items-center gap-x-2",children:t.jsx(l.z,{disabled:!g||y,type:"submit",children:"儲存"})})]})})]})}},45728:(e,s,r)=>{"use strict";r.r(s),r.d(s,{ChapterVideoForm:()=>j});var t=r(60080),i=r(19098),a=r(93258),n=r(57114),c=r(68283),o=r(68384),d=r(82710),l=r(95196),u=r(83104),m=r(9885),h=r.n(m),p=r(10345),x=r(21501);i.Ry({videoUrl:i.Z_().min(1)});let j=({initialData:e,courseId:s,chapterId:r})=>{let[i,m]=h().useState(!1),j=(0,n.useRouter)(),f=()=>m(e=>!e),b=async e=>{try{await a.Z.patch(`/api/courses/${s}/chapters/${r}`,e),p.ZP.success("更新成功"),f(),j.refresh()}catch{p.ZP.error("有東西出錯了")}};return(0,t.jsxs)("div",{className:"mt-6 rounded-md border bg-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between font-medium",children:["章節影片",(0,t.jsxs)(o.z,{variant:"ghost",onClick:f,children:[i&&t.jsx(t.Fragment,{children:"取消"}),!i&&!e.videoUrl&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(d.Z,{className:"mr-2 h-4 w-4"}),"上傳影片"]}),!i&&e.videoUrl&&(0,t.jsxs)(t.Fragment,{children:[t.jsx(l.Z,{className:"mr-2 h-4 w-4"}),"編輯影片"]})]})]}),!i&&(e.videoUrl?t.jsx("div",{className:"relative mt-2 aspect-square",children:t.jsx(c.Z,{playbackId:e.muxData?.playbackId||""})}):t.jsx("div",{className:"flex h-60 items-center justify-center rounded-md bg-slate-200",children:t.jsx(u.Z,{className:"h-10 w-10 text-slate-500"})})),i&&(0,t.jsxs)("div",{children:[t.jsx(x.p,{endpoint:"chapterVideo",onChange:e=>{e&&b({videoUrl:e})}}),t.jsx("div",{className:"mt-4 text-xs text-muted-foreground",children:"上傳本章節的教學影片"})]}),e.videoUrl&&!i&&t.jsx("div",{className:"mt-2 text-xs text-muted-foreground",children:"影片加載可能需要等待幾分鐘，如果看不到影片，請重新整理頁面"})]})}},12300:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>R});var t=r(48144),i=r(2654),a=r(30953),n=r(38798),c=r(40978),o=r(15055),d=r(1013),l=r(60438),u=r(44602),m=r.n(u),h=r(6465),p=r(17536);let x=(0,p.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/_components/chapter-title-form.tsx`),{__esModule:j,$$typeof:f}=x;x.default;let b=x.ChapterTitleForm,v=(0,p.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/_components/chapter-description-form.tsx`),{__esModule:y,$$typeof:g}=v;v.default;let w=v.ChapterDescriptionForm,N=(0,p.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/_components/chapter-access-form.tsx`),{__esModule:I,$$typeof:P}=N;N.default;let C=N.ChapterAccessForm,q=(0,p.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/_components/chapter-video-form.tsx`),{__esModule:Z,$$typeof:_}=q;q.default;let U=q.ChapterVideoForm;var F=r(76563);let k=(0,p.createProxy)(String.raw`/home/runner/work/Udemy-Clone/Udemy-Clone/app/(dashboard)/(routes)/admin/courses/[courseId]/chapters/[chapterId]/_components/chapter-actions.tsx`),{__esModule:$,$$typeof:S}=k,z=k.default,G=async({params:e})=>{let{userId:s}=(0,n.I8)();if(!s)return(0,h.redirect)("/");let r=await a.db.chapter.findUnique({where:{id:e.chapterId,courseId:e.courseId},include:{muxData:!0}});if(!r)return(0,h.redirect)("/");let u=[r.title,r.description,r.videoUrl],p=u.length,x=u.filter(Boolean).length,j=`(${x}/${p})`,f=u.every(Boolean);return(0,t.jsxs)(t.Fragment,{children:[!r.isPublished&&t.jsx(F.j,{variant:"warning",label:"此章節尚未發布，將不會顯示在課程中"}),(0,t.jsxs)("div",{className:"p-6",children:[t.jsx("div",{className:"flex items-center justify-center",children:(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)(m(),{href:`/admin/courses/${e.courseId}`,className:"mb-6 flex w-fit  items-center text-sm transition hover:opacity-75",children:[t.jsx(c.Z,{className:"mr-2 h-4 w-4"}),"返回課程設定"]}),(0,t.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-y-2",children:[t.jsx("h1",{className:"text-xl font-medium",children:"建立章節"}),(0,t.jsxs)("span",{className:"text-sm text-slate-700",children:["完成章節設定步驟 ",j]})]}),t.jsx(z,{disabled:!f,courseId:e.courseId,chapterId:e.chapterId,isPublished:r.isPublished})]})]})}),(0,t.jsxs)("div",{className:"grid-col-1 mt-16 grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(i.G,{icon:o.Z}),t.jsx("h2",{className:"text-xl",children:"完成您的章節設定"})]}),t.jsx(b,{initialData:r,courseId:e.courseId,chapterId:e.chapterId}),t.jsx(w,{initialData:r,courseId:e.courseId,chapterId:e.chapterId})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(i.G,{icon:d.Z}),t.jsx("h2",{className:"text-xl",children:"權限設定"})]}),t.jsx(C,{initialData:r,courseId:e.courseId,chapterId:e.chapterId})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-x-2",children:[t.jsx(i.G,{icon:l.Z}),t.jsx("h2",{className:"text-xl",children:"新增影片"})]}),t.jsx(U,{initialData:r,courseId:e.courseId,chapterId:e.chapterId})]})]})]})]})},R=G}};var s=require("../../../../../../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[5893,3159,6885,2703,7112,2002,1477,7799,953,4650,7120,5062,3644],()=>r(77869));module.exports=t})();